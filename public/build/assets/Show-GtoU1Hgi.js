import{n as N,d as n,j as e,H as b,L as d,e as t}from"./vendor-BLTBOi2W.js";import{A as w}from"./AuthenticatedLayout-DNdVW90a.js";import{P as C}from"./PublicLayout-CsEQEwwg.js";import"./ApplicationLogo-CUVqsJO0.js";function S({book:s,userOwnsBook:p,relatedBooks:l}){const{auth:i}=N().props,g=({children:a,header:r})=>i.user?e.jsx(w,{header:r,children:a}):e.jsx(C,{children:a}),[u,c]=n.useState(!1),[x,j]=n.useState("pesapal"),[o,y]=n.useState(""),m=()=>{if(!i.user){t.get("/login");return}t.post("/shop/purchase",{book_id:s.id,payment_method:x,coupon_code:o})},f=()=>{if(!i.user){t.get("/login");return}t.post("/wishlist",{book_id:s.id})},v=()=>{t.post("/cart/add",{book_id:s.id})};return e.jsxs(g,{header:s.title,children:[e.jsx(b,{title:s.title}),e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs(d,{href:"/shop",className:"inline-flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-6 transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Shop"]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6 sticky top-24",children:[e.jsx("div",{className:"aspect-[3/4] bg-gray-100 rounded-xl overflow-hidden mb-6",children:s.cover_image?e.jsx("img",{src:s.cover_image,alt:s.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:e.jsx("svg",{className:"w-24 h-24",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})})}),e.jsx("div",{className:"space-y-3",children:p?e.jsxs(d,{href:"/library",className:"w-full px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center gap-2 font-medium",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"In Your Library"]}):e.jsxs(e.Fragment,{children:[s.is_free?e.jsx("button",{onClick:m,className:"w-full px-6 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors font-bold shadow-lg shadow-primary-500/30",children:"Get Free Book"}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:v,className:"w-full px-6 py-3 bg-gray-900 text-white rounded-lg hover:bg-black transition-all font-bold",children:"Add to Cart"}),e.jsxs("button",{onClick:()=>c(!0),className:"w-full px-6 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-all font-bold shadow-lg shadow-primary-500/30",children:["Buy Now - ",s.formatted_price]})]}),e.jsxs("button",{onClick:f,className:"w-full px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-lg hover:border-primary-600 hover:text-primary-600 transition-colors flex items-center justify-center gap-2 font-bold",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),"Add to Wishlist"]})]})}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Rating"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 text-yellow-400 fill-current",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"})}),e.jsx("span",{className:"font-medium text-gray-900",children:s.average_rating?Number(s.average_rating).toFixed(1):"N/A"}),e.jsxs("span",{className:"text-gray-500",children:["(",s.reviews_count,")"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Downloads"}),e.jsx("span",{className:"font-medium text-gray-900",children:s.downloads})]}),s.pages&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Pages"}),e.jsx("span",{className:"font-medium text-gray-900",children:s.pages})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Format"}),e.jsx("span",{className:"font-medium text-gray-900 uppercase",children:s.format})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Language"}),e.jsx("span",{className:"font-medium text-gray-900",children:s.language||"English"})]})]})]})}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:s.title}),e.jsxs("p",{className:"text-lg text-gray-600",children:["by ",s.author.name]})]}),e.jsx("span",{className:"px-3 py-1 bg-primary-100 text-primary-700 rounded-full text-sm font-medium capitalize",children:s.type})]}),s.category&&e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Category:"}),e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-sm",children:s.category.name})]}),s.tags&&s.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:s.tags.map((a,r)=>e.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 rounded text-xs",children:["#",a]},r))})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Description"}),e.jsx("div",{className:"prose max-w-none text-gray-700",dangerouslySetInnerHTML:{__html:s.description}})]}),(s.isbn||s.publisher||s.published_date)&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.isbn&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"ISBN"}),e.jsx("p",{className:"font-medium text-gray-900",children:s.isbn})]}),s.publisher&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Publisher"}),e.jsx("p",{className:"font-medium text-gray-900",children:s.publisher})]}),s.published_date&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Published"}),e.jsx("p",{className:"font-medium text-gray-900",children:s.published_date})]})]})]}),s.allow_reviews&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:["Reviews (",s.reviews_count,")"]}),s.reviews&&s.reviews.length>0?e.jsx("div",{className:"space-y-4",children:s.reviews.map(a=>e.jsxs("div",{className:"border-b border-gray-200 pb-4 last:border-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:a.user.name}),e.jsx("div",{className:"flex items-center gap-1",children:[...Array(5)].map((r,h)=>e.jsx("svg",{className:`w-4 h-4 ${h<a.rating?"text-yellow-400 fill-current":"text-gray-300"}`,viewBox:"0 0 20 20",children:e.jsx("path",{d:"M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"})},h))})]}),e.jsx("p",{className:"text-gray-700 text-sm",children:a.review}),e.jsx("span",{className:"text-xs text-gray-500 mt-1 block",children:a.created_at})]},a.id))}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No reviews yet"})]})]})]}),l&&l.length>0&&e.jsxs("div",{className:"mt-12",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Related Books"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:l.map(a=>e.jsxs(d,{href:`/shop/${a.slug}`,className:"group bg-white rounded-[2rem] border border-gray-100 shadow-sm hover:shadow-xl transition-all duration-500 overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"aspect-[3/4.2] bg-gray-50 overflow-hidden relative",children:[a.cover_image?e.jsx("img",{src:a.cover_image,alt:a.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-700"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-300",children:e.jsx("svg",{className:"w-12 h-12 opacity-20",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),e.jsx("div",{className:"absolute top-3 left-3",children:e.jsx("span",{className:"bg-white/90 backdrop-blur-md text-gray-900 text-[8px] font-black tracking-widest px-2 py-1 rounded-full shadow-sm uppercase",children:a.type})})]}),e.jsxs("div",{className:"p-4 flex-1 flex flex-col",children:[e.jsx("h3",{className:"font-black text-sm text-gray-900 line-clamp-2 leading-tight mb-1 group-hover:text-primary-600 transition-colors",children:a.title}),e.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-3",children:a.author.name}),e.jsxs("div",{className:"mt-auto pt-2 border-t border-gray-50 flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-black text-primary-600",children:a.formatted_price}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3 text-amber-400 fill-current",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"})}),e.jsx("span",{className:"text-[10px] font-black text-gray-900",children:a.average_rating?Number(a.average_rating).toFixed(1):"0.0"})]})]})]})]},a.id))})]})]}),u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Complete Purchase"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Method"}),e.jsxs("select",{value:x,onChange:a=>j(a.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"pesapal",children:"Pesapal (Mobile Money & Card)"}),e.jsx("option",{value:"stripe",children:"Credit Card (Stripe)"}),e.jsx("option",{value:"paypal",children:"PayPal"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Coupon Code (Optional)"}),e.jsx("input",{type:"text",value:o,onChange:a=>y(a.target.value),placeholder:"Enter coupon code",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),e.jsx("div",{className:"border-t border-gray-200 pt-4",children:e.jsxs("div",{className:"flex items-center justify-between text-lg font-bold",children:[e.jsx("span",{children:"Total:"}),e.jsx("span",{className:"text-primary-600",children:s.formatted_price})]})})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>c(!1),className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:m,className:"flex-1 px-6 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"Purchase"})]})]})})]})}export{S as default};
